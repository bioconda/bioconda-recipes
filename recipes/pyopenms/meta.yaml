{% set name = "pyopenms" %}
{% set version = "2.8.0dev" %}
package:
  name: {{ name|lower  }}
  version: {{ version  }}

source:
  git_url: https://github.com/OpenMS/OpenMS.git
  git_rev: develop
  git_depth: 1 # (Defaults to -1/not shallow)

build:
  number: 1

requirements:
  build:
    - {{ compiler('cxx') }}
    - make
    - cmake
  host:
    - libopenms ==2.8.0dev
    - llvm-openmp # [osx]
    #- zlib >=1.2
    - libtool
    - libsvm >=3.21
    - xerces-c >=3.2
    - boost-cpp >=1.60
    - qt >=5.5
    #- eigen >=3.3.2
    #- glpk >=4.45
    #- hdf5 >=1.10
    #- bzip2 >=1.0
    #- coinmp >=1.8
    #- sqlite >=3.30      
    - python {{ python }}
    - cython >=0.25.2
    - autowrap >=0.22.6
    - nose
    - numpy {{ numpy }}
    - pandas
  run:
    #- libopenms {{ version }}
    #- {{ pin_compatible('llvm-openmp', max_pin='x.x') }} # [osx]
    #- {{ pin_compatible('zlib', max_pin='x.x') }}
    #- {{ pin_compatible('xerces-c', max_pin='x.x') }}
    #- {{ pin_compatible('boost-cpp', max_pin='x.x') }}
    #- {{ pin_compatible('eigen', max_pin='x.x') }}
    #- {{ pin_compatible('glpk', max_pin='x.x') }}
    #- {{ pin_compatible('hdf5', max_pin='x.x') }}
    #- {{ pin_compatible('bzip2', max_pin='x.x') }}
    #- {{ pin_compatible('qt', max_pin='x.x') }}
    #- {{ pin_compatible('libsvm', max_pin='x.x') }}
    #- {{ pin_compatible('coinmp', max_pin='x.x') }}
    #- {{ pin_compatible('sqlite', max_pin='x.x') }}
    - python {{ python }}
    - numpy {{ numpy }}
    - pandas
test:
  commands:
    - python -c "import pyopenms; print(pyopenms.__version__)"
    # We cant use the PYTHON variable since it does not exist on the biocontainer?!

about:
  home: https://github.com/OpenMS/OpenMS
  license: BSD
  license_file: LICENSE
  summary: python bindings for OpenMS, an open-source software C++ library for LC-MS data management and analyses

extra:
  skip-lints:
    - build_number_needs_reset  # our linter has some issues with multi-package recipes as it seems
    - uses_vcs_url  # only for nightly builds
    - missing_hash  # only for nightly builds
  identifiers:
    - biotools:openms
    - doi:10.1038/nmeth.3959
