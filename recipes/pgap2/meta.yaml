{% set version = "1.0.3" %}
{% set name = "PGAP2" %}

  package:
    name: {{ name|lower }}
    version: {{ version }}

  channels:
    - bioconda
    - conda-forge
    - defaults

  source:
    url: https://files.pythonhosted.org/packages/a1/e9/f414ba305a7910545504d866b5b164ec2b7eb24cd7c07ad99ade68a0ec6c/{{ name|lower }}-{{ version }}-py3-none-any.whl
    sha256: 39e8f56892b94d4c1b214e7297e9cb5de2bcf4c5a543fc6f3be5bb75f0ee6772

  build:
      number: 0
      noarch: python
      run_exports:
        - {{ pin_subpackage('pgap2', max_pin="x") }}
      script: "{{ PYTHON }} -m pip install --no-deps {{ name|upper }}-{{ version }}-py3-none-any.whl"
      entry_points:
        - pgap2=pgap2.main:main

  requirements:
    host:
      - python ==3.10
      - pip

    run:
      - python ==3.10
      - biopython ==1.82
      - networkx ==3.3
      - pyfastani ==0.5.1
      - edlib ==1.3.9
      - loguru ==0.6.0
      - numpy ==1.23.3
      - pandas ==1.5.0
      - pyecharts ==2.0.6
      - scikit-learn ==1.1.2
      - scipy ==1.9.1
      - tqdm ==4.64.1
      - miniFasta
      - tajimas_d

      - cd-hit
      - mmseqs2

      - diamond
      - blast

      - raxml-ng
      - iqtree
      - fasttree

      - muscle
      - mafft
      - perl-bio-tools-run-alignment-tcoffee

      - seqtk
      - mcl

      - miniprot
      - clipkit
      - clonalframeml

      - prodigal

      - htslib

      - r-base
      - r-ggpubr
      - r-ggrepel
      - r-dplyr
      - r-tidyr
      - r-patchwork
      - r-optparse
      - r-fastbaps

  test:
    commands:
      - pgap2 -h
      - Rscript -e "library(ggpubr)"
      - Rscript -e "library(ggrepel)"
      - Rscript -e "library(dplyr)"
      - Rscript -e "library(tidyr)"
      - Rscript -e "library(patchwork)"
      - Rscript -e "library(optparse)"

  about:
    home: "https://github.com/bucongfan/PGAP2"
    license: "MIT"
    summary: "PGAP2: a comprehensive pan-genome analysis pipeline for prokaryotic genomes"
