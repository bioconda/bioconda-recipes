{% set name = "mity" %}
{% set version = '1.1.0' %}
{% set sha256 = "2d407a70632b7cb23792c84346a41d3b186ab0b6d839a335b9173cab42198e1d" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://files.pythonhosted.org/packages/8b/07/911f1a30fcd360a0861a2f6bb887f87a39b2d4cb788123cfbc3856e7f4de/mitywgs-{{ version }}.tar.gz
  sha256: {{ sha256 }}

build:
  number: 0
  noarch: python
  entry_points:
    - mity = mitylib.mity:main
  run_exports:
    - {{ pin_subpackage('mity', max_pin="x.x") }}
  script: {{ PYTHON }} -m pip install . --no-deps --no-build-isolation -vvv

requirements:
  host:
    - pip
    - python >=3.5.4
    # - setuptools >=75.3
  run:
    - bioconda::freebayes >=1.2
    - bioconda::gsort =0.1.4
    - pysam
    - scipy
    - numpy
    - pandas
    - pyyaml
    - xlsxwriter
    - python >=3.5.4

test:
  imports:
    - mitylib
  commands:
    - mity -h

about:
  home: https://github.com/KCCG/mity
  summary: mity is a bioinformatic analysis pipeline designed to call mitochondrial SNV and INDEL variants from Whole Genome Sequencing (WGS) data.
  # description: |
  #   This is a *patched* version of mitosalt that includes:

  #   - a fix for the setup script to allow for installation in a conda environment
  #   - a fix for the download of user-selected reference genomes
  #     - `download-mitosalt-db.sh -h [human_genome_url, blank for custom hg19 genome]`
  #     - `download-mitosalt-db.sh -m [mouse_genome_url, blank for custom GRCm38.p6 genome]`
  #     - `download-mitosalt-db.sh -h [human_genome_url, blank for custom hg19 genome] -m [mouse_genome_url, blank for custom GRCm38.p6 genome]`
  #   - a fix for choosing the destination folder of the reference genomes and indices
  #     - `export MITOSALTDATA=/path/to/mitosalt/genomedata`
  #   - custom config files available in the package at `$CONDA_PREFIX/share/mitosalt-1.1.1-0/`
  license: MIT
  license_family: MIT
  license_file: LICENSE.txt

extra:
  recipe-maintainers:
    - tm4zza
