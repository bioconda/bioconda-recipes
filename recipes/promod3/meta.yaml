{% set name = "ProMod3" %}
{% set version = "3.5.0" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  # url: https://git.scicore.unibas.ch/schwede/{{ name }}/-/archive/{{ version }}/{{ name|lower }}-{{ version }}.tar.gz
  url: https://git.scicore.unibas.ch/schwede/ProMod3/-/archive/conda/ProMod3-conda.tar.gz
  sha256: 6a859116d3079888c471b6883f4e8783b49c4a26091e598d5837d62e648ab043

build:
  number: 0
  run_exports:
    - {{ pin_subpackage(name|lower, max_pin="x.x") }}
  skip: True # [py<312 and aarch64]

requirements:
  build:
    - {{ compiler("cxx") }}
    - cmake
    - ninja
    - pkg-config
  host:
    - python {{ python }}
    - libboost-devel >=1.86,<1.87
    - libboost-python-devel >=1.86,<1.87
    - openmm >=7
    - eigen
    - openstructure >=2.11.0
  run:
    - python {{ python }}
    - {{ pin_compatible("openmm") }}

test:
  source_files:
    - doc/tests/data/1crn.fasta
    - doc/tests/data/1crn_cut.pdb
    - doc/tests/data/1CRNA.hhm
  commands:
    - pm 2>&1 | grep -q Usage
    - pip check
  imports:
    - promod3
  requires:
    - pip

about:
  home: https://openstructure.org/promod3/
  dev_url: https://git.scicore.unibas.ch/schwede/ProMod3
  doc_url: https://openstructure.org/promod3/
  license: Apache-2.0
  license_family: Apache
  license_file: LICENSE
  summary: "ProMod3 is a tool for protein structure prediction and refinement"
  description: |
    ProMod3 is a modelling engine based on the OpenStructure computational
    structural biology framework (www.openstructure.org)
    that can perform all steps required to generate a protein model by
    homology. Its modular design aims at implementing flexible modelling
    pipelines and fast prototyping of novel algorithms.

extra:
  additional-platforms:
    - linux-aarch64
    - osx-arm64
  identifiers:
    - biotools:promod3
    - doi:10.1371/journal.pcbi.1008667
