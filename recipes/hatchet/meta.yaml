{% set name = "hatchet" %}
{% set version = "2.0.1" %}

package:
  name: '{{ name|lower }}'
  version: '{{ version }}'

source:
  - url: https://github.com/raphael-group/{{ name }}/archive/v{{ version }}.tar.gz
    sha256: e8ca462fc4404bacc97b2195e734cd6086eebd40e7941d450c069967d294d988
    patches:
      - FindGUROBI.patch

  - url: https://packages.gurobi.com/11.0/gurobi11.0.2_linux64.tar.gz  # [linux and x86_64]
    sha256: f43ac8a3edb987b9a0a61452acd9d8dbe9eb37368c6da7ce36e5247cb2a1a368  # [linux and x86_64]
    folder: gurobi1102  # [linux and x86_64]

  - url: https://packages.gurobi.com/11.0/gurobi11.0.2_armlinux64.tar.gz  # [linux and aarch64]
    sha256: 311b38a89717e26f3f829479ef8e6776674b2711c427a90b84ac9978acd19ff2  # [linux and aarch64]
    folder: gurobi1102  # [linux and aarch64]

  - url: https://packages.gurobi.com/11.0/gurobi11.0.2_macos_universal2.pkg  # [osx]
    sha256: e5709586ce2c1179bba16656a0855e43a5a3becaf1fbe85e0ab123371448f072  # [osx]

build:
  number: 1
  skip: True  # [py < 37]
  entry_points:
    - hatchet = hatchet.__main__:main
  run_exports:
    - {{ pin_subpackage('hatchet', max_pin="x") }}

requirements:
  build:
    - {{ compiler('cxx') }}
    - cmake >=3.9
    - make
  host:
    - python
    - pip
  run:
    - python
    - bcftools >=1.9
    - biopython
    - hmmlearn
    - matplotlib-base
    - mosdepth
    - pandas
    - picard-slim
    - psutil
    - pyomo
    - pysam
    - requests
    - samtools >=1.9
    - seaborn
    - scikit-learn
    - scipy
    - tabix

test:
  imports:
    - hatchet

about:
  home: https://github.com/raphael-group/hatchet
  license: BSD-3-Clause
  license_family: BSD
  license_file: LICENSE
  summary: "A package to infer allele and clone-specific copy-number aberrations (CNAs)."
  doc_url: https://raphael-group.github.io/hatchet/
  description: |
    HATCHet is an algorithm to infer allele and clone-specific copy-number
    aberrations (CNAs), clone proportions, and whole-genome duplications
    (WGD) for several tumor clones jointly from multiple bulk-tumor samples
    of the same patient or from a single bulk-tumor sample.

extra:
  additional-platforms:
    - linux-aarch64