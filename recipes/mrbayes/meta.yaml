{% set name = "MrBayes" %}
{% set version = "3.2.6" %}

package:
  name: {{ name | lower }}
  version: {{ version }}

source:
  url: https://github.com/NBISweden/{{name}}/archive/v{{version}}.tar.gz
  sha256: 5c8d8b6ef3f281cbb6a7fd93a82cbc9b0e699d2b95571d98184f424b6171d8d1

build:
  number: 2

requirements:
  build:
    - {{ compiler('c') }}
    - autoconf
    - automake
  host:
    - readline 6.*
    - openmpi
    - beagle-lib
  run:
    - readline 6.*
    - openmpi
    - beagle-lib
test:
# conda inspect rules broken in bioconda toolchain
#  requirements:
#    - conda
  commands:
#    - conda inspect linkages -p $PREFIX $PKG_NAME  # [linux]
#    - conda inspect objects -p $PREFIX $PKG_NAME  # [osx]
  - echo Version | mb
  - echo Version | mpirun -mca plm_rsh_agent true --allow-run-as-root mb-mpi

about:
  home: http://mrbayes.sourceforge.net
  license: GPLv3
  license_family: GPL
  license_file: src/gpl.txt
  summary: Bayesian Inference of Phylogeny
  description: |
    MrBayes is a program for Bayesian inference and model choice across a wide
    range of phylogenetic and evolutionary models. MrBayes uses Markov chain
    Monte Carlo (MCMC) methods to estimate the posterior distribution of model
    parameters.

extra:
  identifiers:
    - biotools:mrbayes
