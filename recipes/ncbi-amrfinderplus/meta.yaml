{% set version = "3.7.3" %}
{% set sha256 = "0129ac36860cf5bd0be74b2d77fae9a9711b0ab8514459ae95be402d67482560" %}

package:
  name: ncbi-amrfinderplus
  version: {{ version }}


source:
  url: https://ftp.ncbi.nlm.nih.gov/pathogens/Technical/AMRFinder_technical/amrfinder_src_dist_v{{ version }}.tar.gz
    #  url: https://github.com/ncbi/amr/archive/amrfinder_v{{ version }}.tar.gz
  sha256: {{ sha256 }}

build:
  number: 1

requirements:
  build:
    - {{ compiler('cxx') }}
  host:
    - coreutils
    - libcurl
  run:
    - blast >=2.9
    - hmmer >=3.2
    - libcurl

test:
  files:
    - run_test.sh
  source_files:
    - test_prot.fa
    - test_prot.gff
    - test_dna.fa
    - test_both.expected
  commands:
    - amr_report -help
    - amrfinder --help
    - amrfinder_update --help
    - fasta_check -help
    - fasta2parts -help
    - gff_check -help
    - dna_mutation -help
    - |
        curl --silent \
         -O https://raw.githubusercontent.com/ncbi/amr/master/test_dna.fa \
         -O https://raw.githubusercontent.com/ncbi/amr/master/test_prot.fa \
         -O https://raw.githubusercontent.com/ncbi/amr/master/test_prot.gff \
         -O https://raw.githubusercontent.com/ncbi/amr/master/test_both.expected
        echo "l s$PREFIX"
        ls $PREFIX
        cat /proc/cpuinfo
        pwd -P
        amrfinder -u
        amrfinder --plus -n test_dna.fa -p test_prot.fa -g test_prot.gff -O Escherichia > test_both.got
        diff test_both.expected test_both.got
about:
  home: https://github.com/ncbi/amr/wiki
  license: Public Domain
  license_file: LICENSE
  summary: AMRFinderPlus finds antimicrobial resistance and other genes in protein or nucleotide sequences.
  description: |
      This software and the accompanying database are designed to
      find acquired antimicrobial resistance genes in bacterial protein or
      nucleotide sequences as well as known point mutations for several taxa. With
      AMRFinderPlus we have added select members of additional classes of genes
      such as virulence factors, biocide, heat, acid, and metal resistance genes.
  doc_url: https://github.com/ncbi/amr/wiki


