diff --git a/install_muse.sh b/install_muse.sh
index 7bc2153..6a9ea38 100755
--- a/install_muse.sh
+++ b/install_muse.sh
@@ -6,9 +6,9 @@ mkdir -p lib
 
 # compile boost library
 cd boost_1_70_0/
-./bootstrap.sh
+./bootstrap.sh --with-toolset="${CC}"
 ./b2 --clean
-./b2
+./b2 --prefix="${BOOST_ROOT}" --layout=system link=static threading=multi install toolset="${CC}" "${BOOST_BUILD_LIBS}" > "${BOOST_LOG}" 2>&1
 
 cp stage/lib/libboost_iostreams.a ../lib/
 cd ..
@@ -25,7 +25,7 @@ cd gperftools
 git checkout gperftools-2.9.1
 ./autogen.sh
 ./configure --libdir="$PWD"
-make -j4
+make -j${CPU_COUNT}
 make install
 cp libtcmalloc_minimal.a ../lib/
 cd ..
@@ -43,26 +43,15 @@ git checkout 1.9
 #git submodule update --init --recursive
 autoreconf -i
 ./configure
-make -j4
+make -j${CPU_COUNT}
 cp libhts.a ../lib/
 
 cd ..
 
-make
-
-#clean htslib and gperftools and boost libraries
-rm -r boost_1_70_0/stage
-
-chmod -R 755 gperftools
-rm -r gperftools
-
-chmod -R 755 htslib
-rm -r htslib
-
-
-
-
-
+CFLAGS="${CFLAGS} -O3 ${LDFLAGS}" \
+    CC="${CC}" CXX="${CXX}" CXXFLAGS="${CXXFLAGS} -O3 -I${PREFIX}/include" \
+    LDFLAGS="${LDFLAGS} -L${PREFIX}/lib" \
+    make -j"${CPU_COUNT}"
 
 
 
