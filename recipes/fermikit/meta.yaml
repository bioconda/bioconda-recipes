{% set name = "fermikit" %}
{% set version = "0.14.dev1" %}

package:
  name: {{ name }}
  version: {{ version }}

source:
  url: https://github.com/lh3/fermikit/archive/96f7820c91b01113abf24f4d30cf86a89d8a1ccc.tar.gz
  sha256: c4f5474fb6f6d23427fbf10564de0606621015ef585f88df0ca0e97353db0fec

build:
  number: 2
  run_exports:
    - {{ pin_subpackage(name, max_pin="x.x") }}

requirements:
  build:
    - make
    - {{ compiler('c') }}
  host:
    - perl
    - curl
    - zlib
  run:
    - perl
    - bfc ==r181
    - bwa
    - fermi2
    - htsbox
    - ropebwt2 ==r187
    - seqtk
    - trimadap

test:
  source_files:
    - test/test.sh
    - test/11_1910000_1940000.fa
    - test/HS1011_11_1910000_1940000.fastq.gz
  commands:
    - test -x ${PREFIX}/bin/run-calling
    #- sed -i.bak 's|\.\.\/fermi.kit\/||g' test/test.sh && bash test/test.sh

about:
  home: "https://github.com/lh3/fermikit"
  license: MIT
  license_familly: MIT
  summary: "FermiKit is a de novo assembly based variant calling pipeline for deep Illumina resequencing data."
  dev_url: "https://github.com/lh3/fermikit"

extra:
  additional-platforms:
    - linux-aarch64
    - osx-arm64
