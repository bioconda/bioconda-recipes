diff --git a/CMakeLists.txt b/CMakeLists.txt
index 0ead7e4..745e8b5 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -338,8 +338,8 @@ if (htslib_LOCAL)
   set(flags "-O3 -g -fPIC")
   ExternalProject_Add(htslib-EXT
     SOURCE_DIR "${CMAKE_SOURCE_DIR}/${htslib_LOCAL}"
-    UPDATE_COMMAND autoreconf -if
-    CONFIGURE_COMMAND ./configure --disable-s3 CC=${CC}
+    UPDATE_COMMAND cd htscodecs && autoupdate && autoreconf -if && cd ../ && autoupdate && autoreconf -if
+    CONFIGURE_COMMAND ./configure --enable-libcurl --enable-plugins --disable-s3 LDFLAGS="-L${PREFIX}/lib -Wl,-R${PREFIX}/lib" CPPFLAGS="-I${PREFIX}/include" PKG_CONFIG_PATH="${PREFIX}/lib/pkgconfig"
     INSTALL_COMMAND ""
     BUILD_IN_SOURCE ON
     BUILD_COMMAND $(MAKE) CFLAGS=${flags} lib-static
