diff --git a/CMakeLists.txt b/CMakeLists.txt
index 55c3f4d..3aed5db 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -67,11 +67,6 @@ if(NOT CMAKE_BUILD_TYPE)
           "Choose the type of build, options are: Release|Debug|RelWithDebInfo (for distros)." FORCE)
 endif()
 
-if (${CMAKE_BUILD_TYPE} MATCHES Release)
-  set(EXTRA_FLAGS "-march=native -D_FILE_OFFSET_BITS=64")
-  # set(CMAKE_CXX_FLAGS_RELEASE "-DNDEBUG") # reset CXX_FLAGS to replace -O3 with -Ofast
-endif()
-
 if ((${CMAKE_BUILD_TYPE} MATCHES Release) OR (${CMAKE_BUILD_TYPE} MATCHES RelWithDebInfo))
   set (CMAKE_C_FLAGS "${CMAKE_C_FLAGS} ${EXTRA_FLAGS}")
   set (CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} ${EXTRA_FLAGS}")
@@ -177,13 +172,19 @@ set(vcflib_SOURCE
 
 if (tabixpp_LOCAL) # add the tabixpp source file
     list(APPEND vcflib_SOURCE ${tabixpp_SOURCE})
-    list(APPEND INCLUDES ${TABIXPP_LOCAL}/tabix.hpp)
+    list(APPEND INCLUDES ${tabixpp_LOCAL}/tabix.hpp)
 endif()
 
 add_library(vcflib
     ${vcflib_SOURCE}
     )
 
+target_link_libraries(vcflib PUBLIC
+    tabixpp
+    wfa2
+    hts
+    )
+
 set(BINS
     vcfecho
     dumpContigsFromHeader
@@ -320,6 +321,10 @@ set(SCRIPTS
 file (STRINGS "VERSION" BUILD_NUMBER)
 add_definitions(-DVCFLIB_VERSION="${BUILD_NUMBER}")
 add_definitions(-DVERSION="${BUILD_NUMBER}")
+string(REGEX MATCH "^[0-9]+" MAJOR_BUILD_NUMBER ${BUILD_NUMBER})
+set_target_properties(vcflib PROPERTIES
+	SOVERSION ${MAJOR_BUILD_NUMBER}
+    )
 
 # ---- Build htslib
 #
@@ -331,11 +336,11 @@ if (htslib_LOCAL)
 
   include_directories(${htslib_LOCAL})
 
-  set(flags "-O2 -g -fPIC")
+  set(flags "-O3 -g -fPIC")
   ExternalProject_Add(htslib-EXT
     SOURCE_DIR "${CMAKE_SOURCE_DIR}/${htslib_LOCAL}"
-    UPDATE_COMMAND autoreconf -i
-    CONFIGURE_COMMAND ./configure --disable-s3
+    UPDATE_COMMAND autoreconf -if
+    CONFIGURE_COMMAND ./configure --disable-s3 CC=${CC}
     INSTALL_COMMAND ""
     BUILD_IN_SOURCE ON
     BUILD_COMMAND $(MAKE) CFLAGS=${flags} lib-static
@@ -429,20 +434,6 @@ if (ZIG)
 endif()
 
 
-if (htslib_LOCAL)
-  target_link_libraries(vcflib htslib)
-else (htslib_LOCAL)
-  target_link_libraries(vcflib PkgConfig::htslib)
-endif()
-
-if (NOT tabixpp_LOCAL)
-  target_link_libraries(vcflib PkgConfig::tabixpp)
-endif()
-
-if(OPENMP)
-  target_link_libraries(vcflib OpenMP::OpenMP_CXX)
-endif()
-
 # ---- Build all
 
 if (BUILD_SHARED_LIBS)
@@ -594,6 +585,8 @@ if(WFA_GITMODULE)
   install(TARGETS ${WFALIB} ARCHIVE DESTINATION ${CMAKE_INSTALL_BINDIR})
 endif(WFA_GITMODULE)
 
-install(FILES ${INCLUDES} DESTINATION include/vcflib)
+install(FILES ${INCLUDES} DESTINATION ${CMAKE_INSTALL_INCLUDEDIR}/vcflib)
+configure_file(${CMAKE_CURRENT_SOURCE_DIR}/vcflib.pc.in ${CMAKE_CURRENT_BINARY_DIR}/vcflib.pc @ONLY)
+install(FILES ${CMAKE_CURRENT_BINARY_DIR}/vcflib.pc DESTINATION ${CMAKE_INSTALL_LIBDIR}/pkgconfig)
 
 install(DIRECTORY ${CMAKE_SOURCE_DIR}/man/ DESTINATION ${CMAKE_INSTALL_MANDIR}/man1)
