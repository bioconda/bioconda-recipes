{% set name = "singlem" %}
{% set version = "0.20.3" %}

package:
  name: {{ name }}
  version: {{ version }}

source:
  url: https://pypi.org/packages/source/{{ name[0] }}/{{ name }}/{{ name }}-{{ version }}.tar.gz
  sha256: 4492c2065f3466db6d4f1924bff7a6af108e717eb63e8777bb0ad490c8c8f150

build:
  number: 0
  noarch: python
  script: {{ PYTHON }} -m pip install . --no-deps --no-build-isolation --no-cache-dir -vvv
  run_exports:
    - {{ pin_subpackage('singlem', max_pin="x.x") }}

# Requirements can be adapated from the environment.yml file at https://github.com/wwood/singlem/blob/main/admin/environment.yml
requirements:
  host:
    - pip
    - python >=3.7
    - setuptools
  run:
    - biopython =1.86.*
    - bird_tool_utils_python =0.6.*
    - cd-hit =4.8.*
    - diamond =2.1.16
    - expressbetadiversity =1.0.*
    - extern =0.4.*
    - fastalite =0.4.*
    - fasttree =2.2.*
    - galah =0.4.*
    - graftm =0.15.*
    - hmmer =3.2.*
    - jinja2 =3.1.*
    - krona =2.8.*
    - mafft =7.*
    - mfqe =0.5.*
    - ncbi-ngs-sdk =3.0.*
    - orfm >=0.7.1
    - pandas =2.3.*
    - polars =1.35.*
    - pplacer =1.1.*
    - prodigal =2.6.*
    - pyarrow =22.0.*
    - pyranges =0.1.*
    - python =3.12.*
    - seqmagick =0.8.*
    - smafa =0.8.*
    - sqlalchemy =2.0.*
    - sqlite =3.51.*
    - sqlparse =0.5.*
    - squarify =0.4.*
    - sra-tools =3.2.*
    - tqdm =4.67.*
    - zenodo_backpack =0.4.*

test:
  imports:
    - singlem
  commands:
    - singlem -h

about:
  home: "https://github.com/wwood/singlem"
  license: "GPL-3.0-or-later"
  license_family: "GPL3"
  license_file: "LICENCE.txt"
  summary: 'At heart, SingleM is a tool for profiling shotgun metagenomes. It was originally designed to determine the relative abundance of bacterial and archaeal taxa in a sample. As of version 0.19.0, it can also be used to profile dsDNA phages (see Lyrebird). It shows good accuracy in estimating the relative abundances of community members, and has a particular strength in dealing with novel lineages. The method it uses also makes it suitable for some related tasks, such as assessing eukaryotic contamination, finding bias in genome recovery, and lineage-targeted MAG recovery. It can also be used as the basis for choosing metagenomes which, when coassembled, maximise the recovery of novel MAGs (see Bin Chicken).'
  dev_url: "https://github.com/wwood/singlem"
  doc_url: "https://wwood.github.io/singlem"
