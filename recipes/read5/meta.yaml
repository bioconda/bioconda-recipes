{% set name = "read5" %}
{% set version = "1.1.8" %}

package:
  name: "{{ name|lower }}"
  version: "{{ version }}"

source:
  url: "https://pypi.io/packages/source/{{ name[0] }}/{{ name }}/{{ name }}-{{ version }}.tar.gz"
  sha256: 72b21a375396d3dd720849f44e79d3f974eb21bf5b066cead0aa70ce6a886297

build:
  noarch: python
  number: 0
  script: "{{ PYTHON }} -m pip install --no-deps --ignore-installed -vv ."

requirements:
  host:
    - python
    - pip
  run:
    - python
    - h5py >=3.0
    - numpy >=1.20
    - pyslow5 >=1.0.0
    - ont_vbz_hdf_plugin >=1.0
    - pytest
    # - pod5 >=0.2.3 # currently not available in conda

test:
  source_files:
    - tests
  requires:
    - pytest
  commands:
    - pip install pod5 --no-dependencies
    - pytest -vv

about:
  home: https://github.com/JannesSP/read5
  license: "GNU General Public v3 (GPLv3)"
  license_family: GPL3
  license_file: LICENSE
  summary: "Wrapper to read fast5, slow5, blow5 and pod5 files."
  doc_url: https://github.com/JannesSP/read5.github.io
  dev_url: https://github.com/JannesSP/read5
  description: |
    Read5 is a python wrapper to read fast5, slow5/blow5 and pod5 files using the same overloaded functions from different APIs.

    [![License: GPL v3](https://img.shields.io/badge/License-GPL%20v3-teal.svg)](https://www.gnu.org/licenses/gpl-3.0)
    ![PyPI - Python Version](https://img.shields.io/pypi/pyversions/read5)

    [![PyPI](https://img.shields.io/pypi/v/read5) ![PyPI - Downloads](https://img.shields.io/pypi/dm/read5) ![PyPI - Status](https://img.shields.io/pypi/status/read5)](https://pypi.org/project/read5/)


    [![Anaconda-Server Badge](https://anaconda.org/jannessp/read5/badges/version.svg)](https://anaconda.org/jannessp/read5) ![Conda](https://img.shields.io/conda/dn/jannessp/read5) [![Conda package](https://anaconda.org/jannessp/read5/badges/latest_release_date.svg)](https://anaconda.org/jannessp/read5) [![Conda package](https://anaconda.org/jannessp/read5/badges/platforms.svg)](https://anaconda.org/jannessp/read5)
    
    [![DOI](https://zenodo.org/badge/633012569.svg)](https://zenodo.org/badge/latestdoi/633012569)

    [![Twitter Follow](https://img.shields.io/twitter/follow/Ja_Spangenberg)](https://twitter.com/Ja_Spangenberg)
    ___
    ## Table of Content
    1.  [Installation](#installation)
    2.  [Usage](#usage)
    3.  [Full Documentation](https://jannessp.github.io/read5.github.io/)
    ___
    ## Installation

    ### Pypi/pip
    ```bash
    pip install read5
    ```
    ### Conda
    Pod5 is currently not available via conda (27.06.2023). Please install it using pip in your conda environment.
    ```bash
    conda install mamba
    mamba create -n read5 -c jannessp read5
    conda activate read5
    pip install pod5 # needed as no pod5 conda package available yet
    ```
    Alternatively you can create the environment using the [conda.recipe/env.yml](conda.recipe/env.yml) file.
    ```bash
    conda install mamba
    mamba env create -f conda.recipe/env.yml
    conda activate read5
    ```
    ___
    ## Usage

    [Click here to see a full documentation about the classes and function.](https://jannessp.github.io/read5.github.io/)

    *my_file* can be a fast5, slow5, blow5 or pod5 file. The wrapper detects the file format depending on the file extension.

    ### Small example:

    ```python
    from read5 import read # or from read5.Reader import read

    r5 = read(my_file) # file with on of these extensions: .fast5, .slow5, .blow5, .pod5
    for readid in r5:
        signal = r5.getSignal(readid)
        norm_signal = r5.getZNormSignal(readid) # returns normalised read signal: norm_signal = (signal - median(signal)) / mad(signal)
        channel = r5.getChannelNumber(readid)
        sampleid = r5.getSampleID(readid)
        runid = r5.getSampleID(readid)

    readid_list = r5.getReads()
    ```

    ### File Reader Classes
    If you want to use the file readers you can import the corresponding class like this:

    ```python
    from read5.Fast5Reader import Fast5Reader # contains the Fast5 Reader class
    from read5.Slow5Reader import Slow5Reader # contains the Slow5 Reader class
    from read5.Pod5Reader import Pod5Reader # contains the Pod5 Reader class
    ```

    ### Abstract File Reader Class

    ```python
    from read5.AbstractFileReader import AbstractFileReader
    ```

    ### Possible Exceptions

    ```python
    from read5.Exceptions import UnknownFileFormatException, UnknownNormalizationMode
    ```

    - UnknownFileFormatException: is raised, when the file extension does not match one of ['.fast5', '.slow5', '.blow5', 'pod5']
    - UnknownNormalizationMode: is raised, when an unknown mode is provided for the signal normalization function

    ## Full Documentation
    Created with [pdoc3](https://pdoc3.github.io/pdoc/).
    Can be found [here](https://jannessp.github.io/read5.github.io/).

extra:
  recipe-maintainers:
    - 38325576