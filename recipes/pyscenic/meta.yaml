{% set name = "pyscenic" %}
{% set version = "0.12.1" %}
{% set sha256 = "ae8fafa707d2578ffe08f9eed85f14a4cd9e1b53d57217420e2e956f0a8ddba2" %}

package:
  name: "{{ name|lower }}"
  version: "{{ version }}"

source:
  url: "https://pypi.io/packages/source/{{ name[0] }}/{{ name }}/{{ name }}-{{ version }}.tar.gz"
  sha256: "{{ sha256 }}"

build:
  number: 1
  noarch: python
  entry_points:
    - pyscenic = pyscenic.cli.pyscenic:main
    - db2feather = pyscenic.cli.db2feather:main
    - csv2loom = pyscenic.cli.csv2loom:main
    - invertdb = pyscenic.cli.invertdb:main
    - gmt2regions = pyscenic.cli.gmt2regions:main
  run_exports:
    - "{{ pin_subpackage(name, max_pin='x.x') }}"
  script: "{{ PYTHON }} -m pip install . --no-deps --no-build-isolation --no-cache-dir -vvv"

requirements:
  host:
    - python >=3.7,<=3.10
    - pip
    - setuptools
  run:
    - python >=3.7,<=3.10 # installation/usage instructions say "python 3.7 or greater" and example uses python 3.10: https://pyscenic.readthedocs.io/en/latest/installation.html
    - arboreto >=0.1.6
    - boltons
    - ctxcore >=0.2.0
    - cytoolz
    - dask
    - diptest
    - distributed
    - interlap
    - loompy
    - multiprocessing_on_dill
    - networkx
    - numba >=0.51.2
    - numexpr
    - numpy <1.24 # at this version, the numpy.object syntax used in pyscenic was removed in this numpy version (expired deprecations): https://github.com/numpy/numpy/releases/tag/v1.24.0 
    - pandas >=1.3.5
    - scikit-learn >=0.22.2
    - scipy
    - tqdm

test:
  imports:
    - pyscenic
  commands:
    - pyscenic -h

about:
  home: "https://github.com/aertslab/pySCENIC"
  summary: "Python implementation of the SCENIC pipeline for transcription factor inference from single-cell transcriptomics experiments."
  license: "GPL-3.0-or-later"
  license_family: GPL3
  license_file: "LICENSE.txt"
  dev_url: "https://github.com/aertslab/pySCENIC"
  doc_url: "https://scenic.aertslab.org"

extra:
  identifiers:
    - doi:10.1038/nmeth.4463
    - doi:10.1038/s41592-023-01938-4
    - biotools:scenic
