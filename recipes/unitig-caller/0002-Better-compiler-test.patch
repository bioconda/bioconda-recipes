From daeaa1839a8a2edc43f3c37f98f5fd7aba1145a4 Mon Sep 17 00:00:00 2001
From: John Lees <lees.john6@gmail.com>
Date: Wed, 5 Oct 2022 11:08:37 +0100
Subject: [PATCH 2/2] Better compiler test

---
 CMakeLists.txt | 11 ++++++-----
 1 file changed, 6 insertions(+), 5 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index c3b28e1..c317743 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -4,10 +4,11 @@ project("${TARGET_NAME}")
 add_compile_definitions(PYTHON_EXT)
 
 set(CMAKE_CXX_STANDARD 17)
+message("uc_install=$ENV{UC_INSTALL}")
 # older compilers use experimental::filesystem
-if($ENV{UC_INSTALL} STREQUAL "conda" AND CMAKE_COMPILER_IS_CLANG)
+if("$ENV{UC_INSTALL}" STREQUAL "conda" AND CMAKE_CXX_COMPILER_ID MATCHES "Clang")
     set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -DFS_EXP")
-elseif(NOT $ENV{UC_INSTALL} STREQUAL "conda" AND CMAKE_COMPILER_IS_GNUCC)
+elseif(NOT "$ENV{UC_INSTALL}" STREQUAL "conda" AND CMAKE_CXX_COMPILER_ID MATCHES "GCC")
     set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -DFS_EXP -fconcepts")
 endif()
 
@@ -73,8 +74,8 @@ else()
     endif()
 endif()
 # older compilers use experimental::filesystem
-if($ENV{UC_INSTALL} STREQUAL "conda" AND CMAKE_COMPILER_IS_CLANG)
+if("$ENV{UC_INSTALL}" STREQUAL "conda" AND CMAKE_CXX_COMPILER_ID MATCHES "Clang")
     target_link_libraries("${TARGET_NAME}" PRIVATE c++fs)
-elseif(NOT $ENV{UC_INSTALL} STREQUAL "conda" AND CMAKE_COMPILER_IS_GNUCC)
+elseif(NOT "$ENV{UC_INSTALL}" STREQUAL "conda" AND CMAKE_CXX_COMPILER_ID MATCHES "GCC")
     target_link_libraries("${TARGET_NAME}" PRIVATE stdc++fs)
-endif()
+endif()
\ No newline at end of file
-- 
2.30.1 (Apple Git-130)

