{% set name = "pplacer" %}
{% set version = "1.1.alpha21" %}
{% set sha256 = "acfd2dc61451870a936138f8b0aaa911491b6028a81da766fc4b410097cb9bff" %}

package:
  name: pplacer
  version: '{{ version }}'

source:
  - url: https://github.com/matsen/pplacer/archive/refs/tags/v{{version}}.tar.gz  # [linux]
    sha256: {{ sha256 }}   # [linux]
  - git_url: https://github.com/fhcrc/mcl   # [linux]
    git_rev: b1f7a969371d434eaa6848bdbb79a851de617c1f  # [linux]
    depth: 1  # [linux]
    folder: mcl  # [linux]
    sha256: unused  # [linux]
  - url: https://github.com/matsen/pplacer/releases/download/v1.1.alpha21/pplacer-macos-arm64.zip  # [osx and arm64]
    sha256: 84f470f8329f37d15562613964d83e657138734ebd92ba4253c1b983bf8b92df  # [osx and arm64]
    
build:
  number: 0
  skip: true  # [osx and x86_64]
  run_exports:
    - {{ pin_subpackage(name , max_pin=None) }}


requirements:
  build:
    - make   # [linux]
    - {{ compiler('c') }}  # [linux]
    - ocaml =4.14.2 # [linux]
    - opam =2.1.3  # [linux]
  host:
    - zlib    # [linux]
    - sqlite  # [linux]
    - gsl =2.8 
  run:
    - gsl     # [osx]
    - zlib    # [osx]
    - sqlite  # [osx]

test:
  commands:
    - pplacer --help > /dev/null
    - guppy to_csv --help > /dev/null
    - rppr check --help > /dev/null

about:
  home: http://matsen.fredhutch.org/pplacer/
  license: GPL-3.0
  license_family: GPL
  summary: Pplacer places query sequences on a fixed reference phylogenetic tree to
    maximize phylogenetic likelihood or posterior probability according to a reference
    alignment.
  dev_url: https://github.com/matsen/pplacer/

extra:
  additional-platforms:
    - linux-aarch64
    - osx-arm64
  skip-lints:
    - uses_vcs_url
