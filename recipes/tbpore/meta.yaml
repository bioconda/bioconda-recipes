{% set name = "tbpore" %}
{% set version = "0.1.0" %}
{% set repo_URL = "https://github.com/mbhall88/tbpore/" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: {{ repo_URL }}/archive/refs/tags/{{ version }}.tar.gz
  sha256: 5e7fa6c7b25dfdbd5fbd5970ac5584c27bcd912d21eea6eeebde16f12921ff15
  
build:
  number: 0
  noarch: python
  entry_points:
    - tbpore = tbpore.tbpore:main
  script: "{{ PYTHON }} -m pip install . -vv"

requirements:
  host:
    - poetry=1.1
    - python >=3.8,<4.0
    - pip
    - black >=22.3.0
    - isort=5.10.1
    - flake8=4.0.1
    - pytest=6.2.5
    - pytest-cov=3.0.0
    - ca-certificates
    - certifi
    - openssl
    - libdeflate >=1.10,<1.11.0a0
    - htslib >=1.13,<1.14.0a0
  
  run:
    - mykrobe=0.11
    - rasusa
    - samtools=1.13
    - bcftools=1.13
    - minimap2=2.22
    - seqkit=2.0.0
    - psdm=0.1.0
    - importlib_metadata >=1.7,<2.0.0
    - click=8.0.3
    - cyvcf2=0.30
    - loguru=0.5.3
    - pyyaml >=6.0
    - pandas=1.4.2
    - pysam=0.19.0
    - networkx=2.8
    - ca-certificates
    - certifi
    - openssl
    - libdeflate >=1.10,<1.11.0a0
    - htslib >=1.13,<1.14.0a0


test:
  commands:
    - poetry run black --check .
    - poetry run isort --check .
    - poetry run flake8 . --extend-exclude=".venv/,pipelines/snakemake"
    - poetry run pytest -vv tests/
    - tbpore -h

about:
  home: {{ repo_URL }}
  license: MIT
  license_file: LICENSE
  summary: Mycobacterium tuberculosis genomic analysis from Nanopore sequencing data


extra:
  recipe-maintainers:
    - mbhall88
    - leoisl
