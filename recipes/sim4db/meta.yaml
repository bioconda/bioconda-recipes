{% set name = "sim4db" %}
{% set version = "2008" %}

package:
  name: {{ name }}
  version: {{ version }}

source:
  url: https://sourceforge.net/projects/kmer/files/sim4db-r{{ version }}.tar.bz2
  sha256: 26501c2fff4ac6c5049db9a0272a80aa83340dfd7f1ee8f0a1c409011b6abde8
  patches:
    - 0001-configure.sh.patch
    - Makefile.patch

build:
  number: 2
  run_exports:
    - {{ pin_subpackage(name, max_pin=None) }}

requirements:
  build:
    - make
    - {{ compiler('c') }}
    - {{ compiler('cxx') }}
    - pkg-config
    - python >=3
  host:
    - bzip2
    - perl
  run:
    - perl

test:
  commands:
    - comparePolishes 2>&1 | grep comparePolishes
    - convertPolishes --help 2>&1 | grep convertPolishes
    - convertToAtac 2>&1 | grep convertToAtac
    - leaff 2>&1 | grep leaff
    - mergePolishes 2>&1 | grep mergePolishes
    - mt19937ar-test
    - pickBestPair 2>&1 | grep pickBestPair
    - removeRedundant 2>&1 | grep removeRedundant
    - reportAlignmentDifferences 2>&1 | grep reportAlignmentDifferences
    - sim4db 2>&1 | grep sim4db

about:
  home: "https://sourceforge.net/projects/kmer"
  license: "GPL-3.0-or-later"
  license_family: GPL3
  summary: "Sim4db and leaff: Utilities for fast batch spliced alignment and sequence indexing."

extra:
  additional-platforms:
    - linux-aarch64
    - osx-arm64
