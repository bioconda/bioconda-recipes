{% set version = "1.0.1" %}
{% set name = "stPipe" %}
{% set bioc = "3.22" %}

package:
  name: bioconductor-{{ name|lower }}
  version: '{{ version }}'

source:
  url:
    - https://bioconductor.org/packages/{{ bioc }}/bioc/src/contrib/{{ name }}_{{ version }}.tar.gz
    - https://bioconductor.org/packages/{{ bioc }}/bioc/src/contrib/Archive/{{ name }}/{{ name }}_{{ version }}.tar.gz
    - https://bioarchive.galaxyproject.org/{{ name }}_{{ version }}.tar.gz
    - https://depot.galaxyproject.org/software/bioconductor-{{ name|lower }}/bioconductor-{{ name|lower }}_{{ version }}_src_all.tar.gz
  md5: a2ff45d757519198afabfdffa8bffff4

build:
  number: 0
  rpaths:
    - lib/R/lib/
    - lib/
  run_exports: '{{ pin_subpackage("bioconductor-stpipe", max_pin="x.x") }}'

# Suggests: knitr, plotly, BiocStyle, testthat (>= 3.0.0)
# SystemRequirements: GNU make
requirements:

  build:
    - {{ compiler('c') }}
    - {{ compiler('cxx') }}
    - make

  host:
    - bioconductor-basilisk >=1.22.0,<1.23.0
    - bioconductor-dropletutils >=1.30.0,<1.31.0
    - bioconductor-rhdf5lib >=1.32.0,<1.33.0
    - bioconductor-rhtslib >=3.6.0,<3.7.0
    - bioconductor-rsubread >=2.24.0,<2.25.0
    - bioconductor-scpipe >=2.10.0,<2.11.0
    - bioconductor-singlecellexperiment >=1.32.0,<1.33.0
    - bioconductor-spatialexperiment >=1.20.0,<1.21.0
    - bioconductor-summarizedexperiment >=1.40.0,<1.41.0
    - r-base
    - r-data.table
    - r-dplyr
    - r-ggplot2
    - r-pbmcapply
    - r-rcpp
    - r-reticulate
    - r-rmarkdown
    - r-rtsne
    - r-seurat
    - r-seuratobject
    - r-shiny
    - r-testthat
    - r-umap
    - r-yaml
    - libblas
    - liblapack
    - zlib
    - liblzma-devel

  run:
    - bioconductor-basilisk >=1.22.0,<1.23.0
    - bioconductor-dropletutils >=1.30.0,<1.31.0
    - bioconductor-rhdf5lib >=1.32.0,<1.33.0
    - bioconductor-rhtslib >=3.6.0,<3.7.0
    - bioconductor-rsubread >=2.24.0,<2.25.0
    - bioconductor-scpipe >=2.10.0,<2.11.0
    - bioconductor-singlecellexperiment >=1.32.0,<1.33.0
    - bioconductor-spatialexperiment >=1.20.0,<1.21.0
    - bioconductor-summarizedexperiment >=1.40.0,<1.41.0
    - r-base
    - r-data.table
    - r-dplyr
    - r-ggplot2
    - r-pbmcapply
    - r-rcpp
    - r-reticulate
    - r-rmarkdown
    - r-rtsne
    - r-seurat
    - r-seuratobject
    - r-shiny
    - r-testthat
    - r-umap
    - r-yaml

test:
  commands:
    - $R -e "library('{{ name }}')"

about:
  home: https://bioconductor.org/packages/{{ bioc }}/bioc/html/{{ name }}.html
  license: GPL-3.0-only
  summary: Upstream pre-processing for Sequencing-Based Spatial Transcriptomics
  description: This package serves as an upstream pipeline for pre-processing sequencing-based spatial transcriptomics data. Functions includes FASTQ trimming, BAM file reformatting, index building, spatial barcode detection, demultiplexing, gene count matrix generation with UMI deduplication, QC, and revelant visualization. Config is an essential input for most of the functions which aims to improve reproducibility.
  license_file: '{{ environ["PREFIX"] }}/lib/R/share/licenses/GPL-3'

