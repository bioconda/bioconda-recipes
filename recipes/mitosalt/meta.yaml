{% set name = "MitoSAlt" %}
{% set version = '1.1.1' %}
{% set build_number = 2 %}
{% set sha256 = "5d362e40620c6536d234571f25557613d73fbf30014dd9dbf530ba4c61f13819" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://sourceforge.net/projects/mitosalt/files/{{ name }}_{{ version }}.zip
  sha256: {{ sha256 }}
  patches:
    - setup.patch
    - configs.patch
    - perl_script.patch
    - r_script.patch

build:
  number: {{ build_number }}
  noarch: generic
  run_exports:
    - {{ pin_subpackage('mitosalt', max_pin="x.x") }}

requirements:
  build:
      - wget
      - unzip
  host: []
  run:
    - last =1608
    - bedtools =2.31.1
    - samtools =1.21
    - perl =5.32
    - r-base =4.3.3
    - r-plotrix =3.8_4
    - r-rcolorbrewer =1.1
    - bioconductor-biostrings =2.70.1
    - openjdk >=11.0.1

test:
  commands:
    - test -f ${PREFIX}/bin/mitosalt.pl
    - test -f ${PREFIX}/bin/mitosalt_se.pl

about:
  home: https://sourceforge.net/projects/mitosalt/
  summary: MitoSAlt is a pipeline to identify large deletions and duplications in human and mouse mitochondrial genomes from next generation whole genome/exome sequencing data. The pipeline is capable of analyzing any circular genome in principle, as long as a proper configuration file is provided.
  description: |
    This mitosalt version:

    - lets us choose the destination folder of the reference genomes and indices
      - `export MITOSALT_DATA=/path/to/mitosalt/genomedata`
    - downloads user-selected reference genomes and builds indices
      - `download-mitosalt-db.sh -h [human_genome_url, blank for custom hg19 genome]`
      - `download-mitosalt-db.sh -m [mouse_genome_url, blank for custom GRCm38.p6 genome]`
      - `download-mitosalt-db.sh -h [human_genome_url, blank for custom hg19 genome] -m [mouse_genome_url, blank for custom GRCm38.p6 genome]`
    - runs the pipeline with paired-end reads
      - `mitosalt.pl <config_file> <fastq file 1> <fastq file 2> <study name>`
    - runs the pipeline with single-end reads
      - `mitosalt_se.pl <config_file> <fastq file> <study name>`
    - provides configuration file template in the package at `$CONDA_PREFIX/share/mitosalt-{{ version }}-{{ build_number }}/`
    
  license: MIT-0
  license_family: MIT
  license_file: LICENSE.txt

extra:
  recipe-maintainers:
    - tm4zza
