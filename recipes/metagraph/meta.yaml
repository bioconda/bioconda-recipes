{% set name = "metagraph" %}
{% set version = "0.4.5" %}

package:
  name: {{ name }}
  version: {{ version }}

source:
  url: https://github.com/ratschlab/metagraph/archive/cc7cc94948c77094e36fd97c94490f0be003e592.tar.gz
  sha256: 83205d7621f779219f4157366ef7b818fb67a3c99586cf41c6f102f2ce432f3b
  patches:
    - add_zlib_include_to_sshash.patch

build:
  number: 1
  skip: True  # [win]
  run_exports:
    - {{ pin_subpackage(name, max_pin="x.x") }}

requirements:
  build:
    - {{ compiler('cxx') }}
    - make
    - cmake
    - autoconf
    - automake
    - libtool
    - pkg-config
    - python >=3
    - setuptools
    - libdeflate
    - icu  # [osx,osx-arm64]
    - zstd
    - bzip2
  host:
    - jemalloc  # [linux]
    - boost-cpp
    - libgomp  # [linux]
    - llvm-openmp  # [osx,osx-arm64]
  run:
    - jemalloc  # [linux]
    - boost-cpp
    - libgomp  # [linux]
    - llvm-openmp  # [osx,osx-arm64]

test:
  commands:
    - metagraph_DNA --help
    - metagraph_Protein --help
    - metagraph --help

about:
  home: "https://github.com/ratschlab/metagraph"
  license: MIT
  license_family: MIT
  license_file: LICENSE
  summary: "Ultra Scalable Framework for DNA Search, Alignment, Assembly."
  description: |
    The MetaGraph framework allows for indexing and analysis of very large biological sequence collections, producing compressed indexes that can represent several petabases of input data. The indexes can be efficiently queried with any query sequence of interest.
  doc_url: "https://metagraph.ethz.ch"
  dev_url: "https://github.com/ratschlab/metagraph"

extra:
  recipe-maintainers:
    - adamant-pwn
    - izcram
    - karasikov
  additional-platforms:
    - linux-aarch64
    - osx-arm64
