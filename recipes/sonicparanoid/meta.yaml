# Project ID of SonicParanoid in git lab is 11148448

{% set name = "sonicparanoid" %}
{% set version = "3.6.0a1" %}
{% set commit = "6af30d9d7e7ebf40ca151ccbe2de56bdb1ccea8a" %}
{% set projectid = "11148448" %}
{% set branch = "feat-dmnd" %}

# Working example of link that can be downloaded
# https://gitlab.com/api/v4/projects/11148448/repository/archive.zip?sha=6af30d9d7e7ebf40ca151ccbe2de56bdb1ccea8a

package:
  name: "{{ name|lower }}"
  version: "{{ version }}"

source:
  # url: https://test-files.pythonhosted.org/packages/1a/cb/695641bfcdd8005610728d8a6d6c8c2672faa971b2dd8bbd7740684fe70b/sonicparanoid-1.3.6b1.tar.gz
  # sha256: 660f23d77c83963a25a25ebdcf35b76181734bdaf809418e4343f0288a31b829
  url: https://gitlab.com/salvo981/sonicparanoid2/-/archive/{{ branch }}/sonicparanoid2-{{ branch }}.zip
  sha256: a44d190254ae0f27e09112e6dee7bd8e4b615c09d6759590af139a8fd9072949

  # Old URLs
  # url: https://gitlab.com/salvo981/sonicparanoid2/-/archive/feat-dmnd/sonicparanoid2-feat-dmnd.zip

build:
  number: 0
  skip: True  # [py<36 or py>39]
  script: "{{ PYTHON }} -m pip install . --no-deps --no-cache-dir --use-feature=in-tree-build -vvv "

requirements:
  build:
      - numpy >=1.21
  host:
    - {{ compiler("cxx") }}
    - {{ compiler('c') }}
    - python ==3.8
    - pip >=21.2.4
    - setuptools >=57.4.0
    - wheel >=0.37.0
    - Cython >=0.29.24
    - numpy >=1.21
    - pandas >=1.3.2
    - scipy >=1.7.1
    - biopython >=1.79
    - mypy >=0.910
    - psutil >=5.8.0
    - scikit-learn >=0.24.2
    - filetype >=1.0.7
  run:
    # - {{ compiler("cxx") }}
    # - {{ compiler('c') }}
    - python ==3.8
    - mmseqs2 ==13.45111
    - diamond ==2.0.11
    - blast ==2.12.0
    - mcl ==14.137

test:
  commands:
    # - "sonicparanoid-get-test-data --help"
    - "python -m pip install pip==21.2.4 setuptools==57.4.0 wheel==0.37.0 Cython==0.29.24 numpy==1.21 pandas==1.3.2 scipy==1.7.1 biopython==1.79 mypy==0.910 psutil==5.8.0 scikit-learn==0.24.2 filetype==1.0.7"
    - "sonicparanoid --help"

about:
  home: "http://iwasakilab.bs.s.u-tokyo.ac.jp/sonicparanoid/"
  license: "GNU General Public License v3"
  license_family: "GPL3"
  license_file: "LICENSE.md"
  summary: "SonicParanoid: fast, easy and accurate orthology inference"

extra:
  identifiers:
    - doi:10.1093/bioinformatics/bty631
  skip-lints:
    - cython_must_be_in_host
    - compilers_must_be_in_build
