
KmerGenie
---------

installation:

    1) Prerequisite: Python >= 2.5, RScript (included in R), a C++ compiler, zlib.
    2) Type `make` in the KmerGenie directory
    3) Optionally, `make install` will create a symbolic link of kmergenie to /usr/local/bin (yet, do not delete the original install folder)

usage:

    ./kmergenie reads_file

reads_file is either a FASTA, FASTQ, FASTA.gz, FASTQ.gz file or a list of file names, one per line.

    type ./kmergenie to see extra options

input:

    Input reads should be exactly those the de novo assembler will use to create contigs, i.e. the list of all single and paired-end reads.

    The order does not matter, KmerGenie treats the reads as an unordered set of k-mers. Orientation of the reads also does not matter.
    With Velvet, if you have mate-pairs, Velvet uses them to create contigs, so do include them in KmerGenie.
    Otherwise, if the mate-pairs are used only for scaffolding (i.e. asm_flag=2 in SOAPdenovo), do not include them.

tips:

    * Take a look at the generated HTML report. It provides a summary of the results, and contains an Advanced Help section to help analysis.

    * There is no need to use Kmergenie for a multi-k assembler, like SPAdes. Default parameters of multi-k assemblers are generally better than a single best k.

    * To support even larger values of k, e.g. up to 200, type `make clean ; make k=200`. By default, Kmergenie is compiled to support values of k up to 121.

    * By default, KmerGenie will perform another pass to estimate k more precisely. You may skip it by using the "--one-pass" option (roughly 2x faster).

    * To run multiple instances of KmerGenie on the same folder, specify the "-o" and "-t" parameters (output prefix, number of threads per instance).

    * The sampling value e ("-e" parameter) makes sure that roughly n/e k-mers are sampled out of the n distinct kmers in the dataset. The datasets are fully analyzed, though. Kmergenie samples from the set of distinct kmers, not from the set of reads.

    * The diploid model should only be used for moderate-high heterozygosity rates. The haploid model works better when only one peak is visible in the histograms (indicating low heterozygosity).

outputs:

    histograms_report.html
        html report of all the results
    histograms.dat
        file containing the raw data for the number of genomic kmers for each k value
    histograms-k*.histo
        files containing raw sampled histograms for each k value
    histograms-k*.histo.pdf
        plots of the histograms and the fits. Colors: red is the fit of the complete statistical model of the histogram (erroneous k-mers + genomic k-mers). With the diploid model, green are only the heterozygous k-mers, blue are only the homozygous k-mers.
    <stdout>
        last line is the best k value
    <return code / error code>
        0 if and only if a best k was found (note: no longer returns the best k as error code)

Contact
-------

Please use this dynamic FAQ system to request help from the authors or other users (questions about analyzing a dataset are welcome): 
 http://biostar.genouest.org

or email the authors at:
 kmergenie@cse.psu.edu


Credits
-------

Parts of the R code is from Quake [Kelley DR, Schatz MC, Salzberg SL] and improvements by Anton Korobeynikov have been integrated.
Parts of Minia C++ code [Chikhi R, Rizk G] are used.
Docopt (http://docopt.org/) is used.
