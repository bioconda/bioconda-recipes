{% set version = "1.8.0" %}
{% set name = "lemur" %}
{% set bioc = "3.22" %}

package:
  name: bioconductor-{{ name|lower }}
  version: '{{ version }}'

source:
  url:
    - https://bioconductor.org/packages/{{ bioc }}/bioc/src/contrib/{{ name }}_{{ version }}.tar.gz
    - https://bioconductor.org/packages/{{ bioc }}/bioc/src/contrib/Archive/{{ name }}/{{ name }}_{{ version }}.tar.gz
    - https://bioarchive.galaxyproject.org/{{ name }}_{{ version }}.tar.gz
    - https://depot.galaxyproject.org/software/bioconductor-{{ name }}/bioconductor-{{ name }}_{{ version }}_src_all.tar.gz
  md5: d56bb4ca489678faa4717a3bdbe9d79d

build:
  number: 0
  rpaths:
    - lib/R/lib/
    - lib/
  run_exports: '{{ pin_subpackage("bioconductor-lemur", max_pin="x.x") }}'

# Suggests: testthat (>= 3.0.0), tidyverse, uwot, dplyr, edgeR, knitr, rmarkdown, BiocStyle
requirements:

  build:
    - {{ compiler('c') }}
    - {{ compiler('cxx') }}
    - make

  host:
    - bioconductor-biocgenerics >=0.56.0,<0.57.0
    - bioconductor-biocneighbors >=2.4.0,<2.5.0
    - bioconductor-delayedmatrixstats >=1.32.0,<1.33.0
    - bioconductor-glmgampoi >=1.22.0,<1.23.0
    - bioconductor-hdf5array >=1.38.0,<1.39.0
    - bioconductor-limma >=3.66.0,<3.67.0
    - bioconductor-matrixgenerics >=1.22.0,<1.23.0
    - bioconductor-s4vectors >=0.48.0,<0.49.0
    - bioconductor-singlecellexperiment >=1.32.0,<1.33.0
    - bioconductor-summarizedexperiment >=1.40.0,<1.41.0
    - r-base
    - r-harmony >=1.2.0
    - r-irlba
    - r-matrix
    - r-matrixstats
    - r-rcpp
    - r-rcpparmadillo
    - r-rlang >=1.1.0
    - r-vctrs >=0.6.0
    - libblas
    - liblapack
    - zlib
    - liblzma-devel

  run:
    - bioconductor-biocgenerics >=0.56.0,<0.57.0
    - bioconductor-biocneighbors >=2.4.0,<2.5.0
    - bioconductor-delayedmatrixstats >=1.32.0,<1.33.0
    - bioconductor-glmgampoi >=1.22.0,<1.23.0
    - bioconductor-hdf5array >=1.38.0,<1.39.0
    - bioconductor-limma >=3.66.0,<3.67.0
    - bioconductor-matrixgenerics >=1.22.0,<1.23.0
    - bioconductor-s4vectors >=0.48.0,<0.49.0
    - bioconductor-singlecellexperiment >=1.32.0,<1.33.0
    - bioconductor-summarizedexperiment >=1.40.0,<1.41.0
    - r-base
    - r-harmony >=1.2.0
    - r-irlba
    - r-matrix
    - r-matrixstats
    - r-rcpp
    - r-rcpparmadillo
    - r-rlang >=1.1.0
    - r-vctrs >=0.6.0

test:
  commands:
    - $R -e "library('{{ name }}')"

about:
  home: https://bioconductor.org/packages/{{ bioc }}/bioc/html/{{ name }}.html
  license: MIT
  summary: Latent Embedding Multivariate Regression
  description: Fit a latent embedding multivariate regression (LEMUR) model to multi-condition single-cell data. The model provides a parametric description of single-cell data measured with treatment vs. control or more complex experimental designs. The parametric model is used to (1) align conditions, (2) predict log fold changes between conditions for all cells, and (3) identify cell neighborhoods with consistent log fold changes. For those neighborhoods, a pseudobulked differential expression test is conducted to assess which genes are significantly changed.
  license_file: LICENSE

