{% set version = "0.17.1" %}

package:
  name: gimmemotifs
  version: {{ version }}

source:
  url: https://github.com/vanheeringen-lab/gimmemotifs/releases/download/{{ version }}/gimmemotifs-{{ version }}.tar.gz
  sha256: 4d73d4b1df0ef765414dac952bf1d26609e74e97f9a2ee2d3d65a09078e1ad4c

build:
  number: 3

outputs:
  - name: gimmemotifs-minimal

    build:
      script: python -m pip install . --no-deps --ignore-installed -vvv
      skip: True  # [py<37 or py>39]  # current pandas pin cannot use 3.10

    requirements:
      # all packages are pinned to reduce RAM usage in the Mulled build
      build:
        - {{ compiler('c') }}
        - {{ compiler('cxx') }}
      host:
        - pip
        - python
      run:
        - biofluff >=3.0.4              # Necessary for coverage_table()
        - configparser >=5.3.0
        - diskcache >=5.4.0
        - feather-format >=0.4.1
        - genomepy >=0.14.0
        - iteround >=1.0.3
        - jinja2 >=3.1.2
        - logomaker >=0.8
        - loguru >=0.6.0
        - matplotlib-base >=3.5.3
        - numpy >=1.21.6
        - pandas >=1.0.3, <=1.1.5       # 1.3.5/1.4.2 are bugged
        - pyarrow >=9.0.0               # can be removed next release.
        - pybedtools >=0.9.0
        - pysam >=0.19.1
        - python
        - python-xxhash >=3.0.0
        - qnorm  >=0.8.1
        - scikit-learn >=1.0.2
        - scipy >=1.7.3
        - seaborn >=0.10.1
        - statsmodels >=0.13.2
        - tqdm >=4.46.1
        - xdg >=5.1.1
        - xgboost >=1.6.2

  - name: gimmemotifs

    requirements:
      run:
        - gimmemotifs-minimal ={{ version }}
        # - ipywidgets >=8.0.2          # Necessary for progress bar in Jupyter notebook. removed to save RAM on Bioconda's tests
        - dinamo >=1.0  # [not osx]
        - gadem >=1.3.1
        - homer >=4.11  # [not osx]
        - meme >=5.4.1
        - prosampler >=1.0
        # - trawler >=2.0               # removed to save RAM on Bioconda's tests
        # - weeder >=2.0                # removed to save RAM on Bioconda's tests
        - xxmotif >=1.6
        # - yamda >=0.1.00e9c9d         # removed to save RAM on Bioconda's tests

test:
  imports:
    - gimmemotifs
  commands:
    - gimme --help

about:
  home: https://github.com/vanheeringen-lab/gimmemotifs
  license: MIT
  summary: Motif prediction pipeline and various motif-related tools
  description: Motif prediction pipeline and various motif-related tools

extra:
  recipe-maintainers:
    - simonvh
    - siebrenf
  identifiers:
    - biotools:gimmemotifs
