{% set name = "GATK4" %}
{% set version = "4.5.0.0" %}
{% set sha256 = "dc1a4471e8bb566397db9894ca18acbf8f40f3fc312c8fad9a8c5390c218e916" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://github.com/broadinstitute/gatk/releases/download/{{ version }}/gatk-{{ version }}.zip
  sha256: {{ sha256 }}

build:
  noarch: generic
  number: 1
  run_exports:
     - {{ pin_subpackage('gatk4', max_pin="x") }}

test:
  commands:
    - java -version
    - gatk -h
    - gatk --list
    - gatk HaplotypeCaller --help
  imports:
    - gcnvkernel

#All packages are listed below following GATK's template, except for tensorflow. 
#The specified version 1.15.0 of tensorflow results in an issue as described in this link: https://github.com/bioconda/bioconda-recipes/issues/45600.outputs:
outputs:
  - name: gatk4
    script: build_main.sh
    requirements:
      build:
        - conda-forge::gcc_impl_linux-64=7.5.0=habd7529_20
        - conda-forge::gcc_linux-64=7.5.0=h47867f9_33
        - conda-forge::gfortran_impl_linux-64=7.5.0=h56cb351_20
        - conda-forge::gfortran_linux-64=7.5.0=h78c8a43_33
        - conda-forge::gxx_impl_linux-64=7.5.0=hd0bb8aa_20
        - conda-forge::gxx_linux-64=7.5.0=h555fc39_33
        - conda-forge::glib=2.66.3=h58526e2_0
        - conda-forge::python=3.6.10=h8356626_1011_cpython
        - unzip
        - wget 
      host:
        - absl-py=0.15.0
        - conda-forge::pip=21.3.1
        - conda-forge::mkl=2019.5
        - conda-forge::mkl-service=2.3.0
        - conda-forge::joblib=1.1.1
        - conda-forge::numpy=1.17.5
        - conda-forge::theano=1.0.4=py36h831f99a_1002
        - defaults::tensorflow=1.15.0=mkl_py36*
        - conda-forge::scipy=1.0.0
        - conda-forge::pymc3=3.1
        - conda-forge::h5py=2.10.0
        - defaults::_tflow_select=2.3.0=mkl
        - conda-forge::keras=2.2.4
        - defaults::intel-openmp=2019.4
        - conda-forge::scikit-learn=0.23.1
        - conda-forge::matplotlib=3.2.1
        - conda-forge::pandas=1.0.3
        - conda-forge::typing_extensions=4.1.1
        - conda-forge::dill=0.3.4
        - conda-forge::gast=0.2.2=py_0
        - conda-forge::biopython=1.76=py36h516909a_0
      run:
        - absl-py=0.15.0
        - conda-forge::python =3.6.10
        - conda-forge::pip=21.3.1
        - conda-forge::mkl=2019.5
        - conda-forge::mkl-service=2.3.0
        - conda-forge::joblib=1.1.1
        - conda-forge::numpy=1.17.5
        - conda-forge::theano=1.0.4=py36h831f99a_1002
        - defaults::tensorflow=1.15.0=mkl_py36*
        - defaults::_tflow_select=2.3.0=mkl
        - conda-forge::scipy=1.0.0
        - conda-forge::pymc3=3.1
        - conda-forge::h5py=2.10.0
        - conda-forge::keras=2.2.4
        - defaults::intel-openmp=2019.4
        - conda-forge::scikit-learn=0.23.1
        - conda-forge::matplotlib=3.2.1
        - conda-forge::pandas=1.0.3
        - conda-forge::typing_extensions=4.1.1
        - conda-forge::dill=0.3.4
        - r-base=3.6.2
        - r-data.table=1.12.8
        - r-dplyr=0.8.5
        - r-getopt=1.20.3
        - r-ggplot2=3.3.0
        - r-gplots=3.0.3
        - r-gsalib=2.1
        - biopython=1.76
        - pyvcf=0.6.8
        - bioconda::pysam=0.15.3

about:
  home: https://www.broadinstitute.org/gatk/
  license: BSD-3-Clause
  license_family: BSD
  summary: Genome Analysis Toolkit (GATK4)
  dev_url: https://github.com/broadinstitute/gatk

extra:
  skip-lints:
    # Theano only needs gcc compiler to run optimized C-implementations
    - compilers_must_be_in_build
    - should_not_be_noarch_compiler
